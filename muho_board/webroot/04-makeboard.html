<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>着順掲示板を作る | 【Python】Tkinterで競馬の着順掲示板を作る</title>
    <link rel="stylesheet" type="text/css" href="css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="css/webstyle.css" />
    <link rel="next" title="チュート" href="02-tutorial.html">
    <link rel="prev" title="設定画面を完成させる" href="03-configwindow.html">
    <meta name="generator" content="Re:VIEW Starter">
  </head>
  <body>
    <div class="page-outer">
      <nav class="side-content">
                <div class="rebuild">
          <a href="javascript:void(0)" onclick="rebuildAndReloadForcedly()">Rebuild and Reload</a>
        </div>
                <a class="nav-title" href="index.html">【Python】Tkinterで競馬の着順掲示板を作る</a>
<ul class="toc toc-1">
    <li class="toc-chapter"><a href="./00-preface.html">まえがき / はじめに</a></li>
    <li class="toc-chapter"><a href="./01-install.html">1 インストール</a></li>
    <li class="toc-chapter"><a href="./02-tuto.html">2 チュートリアル</a></li>
    <li class="toc-chapter"><a href="./03-configwindow.html">3 設定画面を完成させる</a></li>
    <li class="toc-chapter"><a href="./04-makeboard.html">4 着順掲示板を作る</a>
      <ul class="toc toc-2">
        <li class="toc-section"><a href="#h4-1">4.1 掲示板用のウィンドウを作る</a></li>
        <li class="toc-section"><a href="#h4-2">4.2 ラベルを配置する</a></li>
      </ul>
    </li>
    <li class="toc-chapter"><a href="./02-tutorial.html">5 チュート</a></li>
    <li class="toc-chapter"><a href="./03-syntax.html">6 記法</a></li>
    <li class="toc-chapter"><a href="./04-customize.html">7 カスタマイズ</a></li>
    <li class="toc-chapter"><a href="./05-faq.html">8 FAQ</a></li>
    <li class="toc-chapter"><a href="./06-bestpractice.html">9 よりよい本づくり</a></li>
    <li class="toc-chapter"><a href="./91-compare.html">Re:VIEWとの差分</a></li>
    <li class="toc-chapter"><a href="./92-filelist.html">ファイルとフォルダ</a></li>
    <li class="toc-chapter"><a href="./93-background.html">開発の背景</a></li>
    <li class="toc-chapter"><a href="./99-postface.html">あとがき / おわりに</a></li>
</ul>
      </nav>
      <div class="page-inner">
        <header class="page-header">
        </header>
        <main class="page-main">
<h1 class="boldlines center twolines"><a id="h4"></a><span class="secno">第4章</span> <br/>着順掲示板を作る</h1>
<div class="abstract">
<p>いよいよ着順掲示板の再現に入ります。サブウィンドウの作成、ラベルの内容の変更、図形の描画、place()とpack()について学んでいきます。</p>
</div>

<h2 id="makenewwindow" class="leftline"><a id="h4-1"></a><span class="secno">4.1</span> 掲示板用のウィンドウを作る</h2>
<p>ここまではひたすら設定画面を作ってきましたが、本章からは本題である掲示板の作成に入ります。</p>
<p>はじめに、掲示板のためのウィンドウを作成します。前章で作成した<code class="inline-code">createwindow</code>関数に追記していく形で掲示板のGUIを作っていきます。</p>
<div id="newwindow" class="caption-code">
<span class="caption">リスト4.1: リスト4.1: 掲示板用のウィンドウを作る</span>
<pre class="list">import tkinter as tk
from tkinter import ttk
import sys

#掲示板を作り変える関数
def createwindow():
    <del>pass</del>
    <b>board = tk.Toplevel()</b>
    <b>board.geometry('500x850')</b>
    <b>board.resizable(False, False)</b>
    <b>board.title('掲示板')</b>
    <b>board.configure(bg = 'black')</b>
</pre>
</div>
<p>既存のウィンドウからサブのウィンドウを呼び出すには、<code class="inline-code">tk.Toplevel()</code>を使用します。設定画面のcreateボタンを押して掲示板ウィンドウを生成した後、あえて右上の×ボタンを押してプログラムを終了してみてください。<code class="inline-code">tk.Tk()</code>で二つ目のウィンドウを呼び出した場合、そのウィンドウは残ってしまいますが、<code class="inline-code">tk.Toplevel()</code>を使用すればメインのウィンドウを消すとサブのウィンドウも消えてくれます。</p>
<p><code class="inline-code">geometry</code>,<code class="inline-code">resizable</code>,<code class="inline-code">title</code>に関しては、<a href="./02-tuto.html">第2章</a>のはじめに紹介した内容と同様です。その後、<code class="inline-code">configure()</code>で背景色を黒にしています。</p>
<p>しかし、このコードには問題があります。お気づきだとは思いますが、この状態でcreateボタンを連打すると、その分だけサブウィンドウを生成できてしまいます。これを防ぐために、コードを<span class="listref"><a href="./04-makeboard.html#limitwindow">リスト4.2</a></span>のように書き換えましょう。</p>
<div id="limitwindow" class="caption-code">
<span class="caption">リスト4.2: リスト4.2: サブウィンドウの生成を制限する</span>
<pre class="list">#掲示板を作り変える関数
def createwindow():
    <b>global board</b>
    <b>if (board == None or not board.winfo_exists()):</b>
    <span class="indentbar"> </span>   board = tk.Toplevel()
    <span class="indentbar"> </span>   board.geometry('500x850')
    <span class="indentbar"> </span>   board.resizable(False, False)
    <span class="indentbar"> </span>   board.title('掲示板')
    <span class="indentbar"> </span>   board.configure(bg = 'black')

#サブウィンドウを先に定義する
<b>board = None</b>
</pre>
</div>
<p>サブウィンドウの生成を制限するために、<code class="inline-code">winfo_exists()</code>を使用しています。この関数は、ウィンドウが存在すればTrueを、存在しなければFalseを返します。返り値をnotで反転させることによって、ウィンドウが存在しない時だけ<code class="inline-code">tk.Topleve()</code>を呼び出しています。</p>
<p>しかし、この関数はサブウィンドウが存在しているときしか利用できません。そのため、あらかじめ<code class="inline-code">createwindow()</code>の外で<code class="inline-code">board</code>を<code class="inline-code">None</code>(=空っぽの状態)として定義しておき、中のif文の条件に<code class="inline-code">None</code>を追加しています。この場合、<code class="inline-code">board</code>は<code class="inline-code">createwindow()</code>関数の外で宣言された変数になるので、関数の初めに<code class="inline-code">global board</code>と記述することで関数の中でも同じ変数を利用できるようにしています。</p>
<p>この状態でプログラムを実行し、createボタンを連打してみてください。サブウィンドウが</p>

<h2 id="placelabel" class="leftline"><a id="h4-2"></a><span class="secno">4.2</span> ラベルを配置する</h2>
<p>あ</p>

        </main>
        <nav class="page-navi">
          <a href="03-configwindow.html" class="page-prev">&#9664;</a>
          <a href="02-tutorial.html" class="page-next">&#9654;</a>
        </nav>
        <footer>
        </footer>
      </div>
    </div>
    <script>
function rebuildAndReloadForcedly() {
  fetch('/rebuild.js').then((resp)=>{
    resp.text().then((text)=>{ eval(text); });
  });
}
    </script>
    <script src="/rebuild.js?file=04-makeboard.re"></script>
  </body>
</html>
<!-- layout.html5.erb -->
