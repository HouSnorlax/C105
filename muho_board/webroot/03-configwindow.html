<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>設定画面を完成させる | 【Python】Tkinterで競馬の着順掲示板を作る</title>
    <link rel="stylesheet" type="text/css" href="css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="css/webstyle.css" />
    <link rel="next" title="着順掲示板を作る" href="04-makeboard.html">
    <link rel="prev" title="チュートリアル" href="02-tuto.html">
    <meta name="generator" content="Re:VIEW Starter">
  </head>
  <body>
    <div class="page-outer">
      <nav class="side-content">
                <div class="rebuild">
          <a href="javascript:void(0)" onclick="rebuildAndReloadForcedly()">Rebuild and Reload</a>
        </div>
                <a class="nav-title" href="index.html">【Python】Tkinterで競馬の着順掲示板を作る</a>
<ul class="toc toc-1">
    <li class="toc-chapter"><a href="./00-preface.html">まえがき</a></li>
    <li class="toc-chapter"><a href="./01-install.html">1 インストール</a></li>
    <li class="toc-chapter"><a href="./02-tuto.html">2 チュートリアル</a></li>
    <li class="toc-chapter"><a href="./03-configwindow.html">3 設定画面を完成させる</a>
      <ul class="toc toc-2">
        <li class="toc-section"><a href="#h3-1">3.1 テキストボックス</a></li>
        <li class="toc-section"><a href="#h3-2">3.2 プルダウンメニュー</a></li>
        <li class="toc-section"><a href="#h3-3">3.3 スピンボックス</a></li>
        <li class="toc-section"><a href="#h3-4">3.4 チェックボックス</a></li>
        <li class="toc-section"><a href="#h3-5">3.5 ボタン</a></li>
      </ul>
    </li>
    <li class="toc-chapter"><a href="./04-makeboard.html">4 着順掲示板を作る</a></li>
    <li class="toc-chapter"><a href="./99-postface.html">あとがき</a></li>
</ul>
      </nav>
      <div class="page-inner">
        <header class="page-header">
        </header>
        <main class="page-main">
<h1 class="boldlines center twolines"><a id="h3"></a><span class="secno">第3章</span> <br/>設定画面を完成させる</h1>
<div class="abstract">
<p>メニュー、ボックス、ボタンの作成方法を学んでいきます。</p>
</div>

<h2 id="textbox" class="leftline"><a id="h3-1"></a><span class="secno">3.1</span> テキストボックス</h2>
<p>テキストボックスとは、ユーザーが任意の文字を入力できるウィジェットです。ここでは、着差の入力に使用します。</p>
<div id="tbox" class="caption-code">
<span class="caption">リスト3.1: リスト3.1: テキストボックスの作成</span>
<pre class="list">labels.append(tk.Label(root, text='3F 1/10'))

<b>margin_12 = tk.Entry(root)</b> <span class="balloon">← メニュー・ボックス・ボタンの作成:着差の入力</span>
<b>margin_23 = tk.Entry(root)</b>
<b>margin_34 = tk.Entry(root)</b>
<b>margin_45 = tk.Entry(root)</b>

<b>time_min = tk.Entry(root, width=3)</b> <span class="balloon">← 勝ちタイムの設定</span>
<b>time_sec = tk.Entry(root, width=3)</b>
<b>time_sec10 = tk.Entry(root, width=3)</b>

<b>ff_sec = tk.Entry(root, width=3)</b> <span class="balloon">← 4Fタイムの設定</span>
<b>ff_sec10 = tk.Entry(root, width=3)</b>

<b>tf_sec = tk.Entry(root, width=3)</b> <span class="balloon">← 3Fタイムの設定</span>
<b>tf_sec10 = tk.Entry(root, width=3)</b>

for i in range(len(labels)): <span class="balloon">← テキストの配置</span>
    labels[i].grid(column=0, row=i)

<b>margin_12.grid(column=1, row=7)</b> <span class="balloon">← メニュー・ボックス・ボタンの配置:着差の入力</span>
<b>margin_23.grid(column=1, row=8)</b>
<b>margin_34.grid(column=1, row=9)</b>
<b>margin_45.grid(column=1, row=10)</b>

<b>time_min.grid(column=1, row=15)</b> <span class="balloon">← 勝ちタイムの設定</span>
<b>time_sec.grid(column=1, row=16)</b>
<b>time_sec10.grid(column=1, row=17)</b>

<b>ff_sec.grid(column=1, row=18)</b> <span class="balloon">← 4Fタイムの設定</span>
<b>ff_sec10.grid(column=1, row=19)</b>

<b>tf_sec.grid(column=1, row=20)</b> <span class="balloon">← 3Fタイムの設定</span>
<b>tf_sec10.grid(column=1, row=21)</b>
</pre>
</div>
<p>いきなり<code class="inline-code">row=7</code>となっていますが、ここからは解説の都合でウィジェットの作成順が画面での並びと一致しません。ご了承ください。</p>
<p>テキストボックスの作成には、<code class="inline-code">Entry()</code>を使用します。引数として表示させたいウィンドウを渡しています。とても単純ですね。</p>
<p>タイムの設定のコメントがついているボックスは<code class="inline-code">width</code>を使用してメニューの幅を指定しています。このボックスには1桁または2桁の数字しか入力しないので、幅を3に設定しています。</p>
<p>プログラムを実行し、<span class="imgref"><a href="./03-configwindow.html#margintext">図3.1</a></span>のように表示されていれば成功です。</p>
<div id="margintext" class="image">
<img src="images/03-configwindow/margintext.png" alt="作成したテキストボックス" class="img border" />
<p class="caption">
図3.1: 作成したテキストボックス
</p>
</div>
<p></p>
<hr />
<p></p>

<h2 id="pulldown" class="leftline"><a id="h3-2"></a><span class="secno">3.2</span> プルダウンメニュー</h2>
<p>プルダウンメニューとは、あらかじめ用意されたリストから項目を選択できるウィジェットです。<span class="imgref"><a href="./03-configwindow.html#pulldownmenu">図3.2</a></span>のように、場名の選択メニューを作りながら、作成方法を解説します。</p>
<div id="pulldownmenu" class="image">
<img src="images/03-configwindow/pulldownmenu.png" alt="プルダウンメニュー" class="img border" />
<p class="caption">
図3.2: プルダウンメニュー
</p>
</div>
<p>さっそくコードを書いていきましょう。<span class="listref"><a href="./03-configwindow.html#pdown">リスト3.2</a></span>のプログラムを追加してください。</p>
<div id="pdown" class="caption-code">
<span class="caption">リスト3.2: リスト3.2: プルダウンメニューの作成</span>
<pre class="list">import tkinter as tk
<b>from tkinter import ttk</b>

...(省略)...

tf_sec.grid(column=1, row=20) <span class="balloon">← 3Fタイムの設定</span>
labels.append(tk.Label(root, text = '3F 1/10 sec'))

<b>course = ttk.Combobox(root,  values=['　　','札幌','函館','福島','新潟','中山','東京','中京','京都','阪神','小倉'], width=4)</b> <span class="balloon">← メニュー・ボックス・ボタンの作成:レース場名</span>

margin_12.grid(column=1, row=7) <span class="balloon">← 着差の入力</span>

...(省略)...

for i in range(len(labels)): <span class="balloon">← テキストの配置</span>
    labels[i].grid(column=0, row=i)

<b>course.grid(column=1, row=0)</b> <span class="balloon">← メニュー・ボックス・ボタンの配置:レース場名</span>

margin_12.grid(column=1, row=7) <span class="balloon">← 着差の入力</span>
</pre>
</div>
<p>ここで、<code class="inline-code">ttk</code>という新たなモジュールをインポートしています。より機能が充実したTkinterという風に思っていただければ大丈夫です。</p>
<p>また、<code class="inline-code">tk</code>と非常に似ているのでプログラムのミスに注意してください。あまりにも紛らわしいのであれば一行目の<code class="inline-code">as tk</code>を削除したり(プログラム中の<code class="inline-code">tk</code>を全て修正することになります)、<code class="inline-code">ttk</code>を別の名前でインポートしても構いません。</p>
<p>プルダウンメニューの作成には、<code class="inline-code">ttk.Combobox()</code>を使用します。<code class="inline-code">values</code>にリストを代入すると、その要素がそのまま選択肢になります。</p>
<p>また、メニューの下三角以外の部分をクリックすると、直接文字を入力することができます。本書では中央競馬の掲示板の再現を目的としているので、選択肢には中央競馬場のみ用意しましたが、地方競馬や廃止となってしまった競馬場の名前を入力して楽しむこともできます。</p>
<p>ここでおことわりなのですが、今回作成する掲示板はレイアウトの都合上三文字の競馬場に対応していません。名古屋競馬ファンの皆様、ごめんなさい……(そもそも地方競馬は掲示板の見た目が異なりますが)</p>

<h4><a id="h3-2-0-1"></a>直接の入力を禁止する</h4>
<p>しかし、なんでもかんでも入力されてしまうと困る場面もあります。引数の中に<code class="inline-code">state=&quot;readonly&quot;</code>と追加することで、プルダウンメニューを読み取り専用にできます。</p>
<div id="denyinput" class="caption-code">
<span class="caption">リスト3.3: リスト3.3: 入力の禁止</span>
<pre class="list">course = ttk.Combobox(root,  values=['　　','札幌','函館','福島','新潟','中山','東京','中京','京都','阪神','小倉'], width=4) <span class="balloon">← メニュー・ボックス・ボタンの作成:レース場名</span>

...(省略)...

margin_45 = tk.Entry(root)

<b>shiba_c = ttk.Combobox(root, state=&quot;readonly&quot;, values=['　','良','稍重','重','不良'], width=4)</b> <span class="balloon">← 馬場状態</span>
<b>dirt_c = ttk.Combobox(root, state=&quot;readonly&quot;, values=['　','良','稍重','重','不良'], width=4)</b>

<b>kakutei = ttk.Combobox(root, state=&quot;readonly&quot;, values=['　','確定','審議'], width=4)</b> <span class="balloon">← 確定状況の設定</span>

...(省略)...

course.grid(column=1, row=0) <span class="balloon">← メニュー・ボックス・ボタンの配置:レース場名</span>

...(省略)...

margin_45.grid(column=1, row=10)

<b>shiba_c.grid(column=1, row=11)</b> <span class="balloon">← 馬場状態</span>
<b>dirt_c.grid(column=1, row=12)</b>

<b>kakutei.grid(column=1, row=13)</b> <span class="balloon">← 確定状況の設定</span>
</pre>
</div>
<p>プログラムを実行して、<span class="imgref"><a href="./03-configwindow.html#pulldowncomp">図3.3</a></span>のようになっていれば大丈夫です。</p>
<div id="pulldowncomp" class="image">
<img src="images/03-configwindow/pulldowncomp.png" alt="現時点での完成図" class="img border" />
<p class="caption">
図3.3: 現時点での完成図
</p>
</div>
<p></p>
<hr />
<p></p>

<h2 id="spinbox" class="leftline"><a id="h3-3"></a><span class="secno">3.3</span> スピンボックス</h2>
<p>スピンボックスとは、数値を入力するためのテキストボックスです。数値を直接入力できるほかに、上下の三角ボタンを使って数値を増減させることもできます。</p>
<div id="spinb" class="caption-code">
<span class="caption">リスト3.4: リスト3.4: スピンボックスの作成</span>
<pre class="list">course = ttk.Combobox(root,  values=['　　','札幌','函館','福島','新潟','中山','東京','中京','京都','阪神','小倉'], width=4) <span class="balloon">← メニュー・ボックス・ボタンの作成:レース場名</span>

<b>race_no = tk.Spinbox(root, from_=1, to=12, width=3)</b> <span class="balloon">← レース番号</span>

<b>first_h = tk.Spinbox(root, from_=1, to=18, width=3)</b> <span class="balloon">← 馬番の入力</span>
<b>second_h = tk.Spinbox(root, from_=1, to=18, width=3) </b>
<b>third_h = tk.Spinbox(root, from_=1, to=18, width=3) </b>
<b>fourth_h = tk.Spinbox(root, from_=1, to=18, width=3) </b>
<b>fifth_h = tk.Spinbox(root, from_=1, to=18, width=3)</b>

...(省略)...

course.grid(column=1, row=0) <span class="balloon">← メニュー・ボックス・ボタンの配置:レース場名</span>

<b>race_no.grid(column=1, row=1)</b> <span class="balloon">← レース番号</span>

<b>first_h.grid(column=1, row=2)</b> <span class="balloon">← 馬番の入力</span>
<b>second_h.grid(column=1, row=3)</b>
<b>third_h.grid(column=1, row=4)</b>
<b>fourth_h.grid(column=1, row=5)</b>
<b>fifth_h.grid(column=1, row=6)</b>
</pre>
</div>
<p>スピンボックスの作成には、<code class="inline-code">Spinbox()</code>を使用します。<code class="inline-code">from_</code>で数値の下限、<code class="inline-code">to</code>で上限を設定します。</p>
<p>プログラムを実行してみましょう。<span class="imgref"><a href="./03-configwindow.html#spinbx">図3.4</a></span>のように三角ボタンがついたボックスが連なるはずです。ボタンを押して、レース番号は1～12まで、馬番は1～18までしか変更できないことを確認してみてください。</p>
<p>ちなみに、ボックスに直接入力する場合は、設定した上限と下限に収まらない数字や、文字列を入力することもできてしまいます。直接入力を制限したい場合は、<span class="listref"><a href="./03-configwindow.html#denyinput">リスト3.3</a></span>と同様に、<code class="inline-code">state=&quot;readonly&quot;</code>を利用するとよいでしょう。ただし、この場合は馬番を空にすることができなくなります。</p>
<div id="spinbx" class="image">
<img src="images/03-configwindow/spinbx.png" alt="作成したスピンボックス" class="img border" />
<p class="caption">
図3.4: 作成したスピンボックス
</p>
</div>
<p></p>
<hr />
<p></p>

<h2 id="checkbox" class="leftline"><a id="h3-4"></a><span class="secno">3.4</span> チェックボックス</h2>
<p>チェックボックスとは、複数の選択肢から任意の項目を選択する際に使われるウィジェットです。ですが、今回は簡易的なトグル(ON/OFF)スイッチとしてチェックボックスを利用してみます。</p>
<div id="checkb" class="caption-code">
<span class="caption">リスト3.5: リスト3.5: チェックボックスの作成</span>
<pre class="list">course = ttk.Combobox(root,  values=['　　','札幌','函館','福島','新潟','中山','東京','中京','京都','阪神','小倉'], width=4) <span class="balloon">← メニュー・ボックス・ボタンの作成:レース場名</span>

...(省略)...

kakutei = ttk.Combobox(root, state=&quot;readonly&quot;, values=['　','確定','審議'], width=4) <span class="balloon">← 確定状況の設定</span>

<b>var_record = tk.BooleanVar()</b>
<b>record = tk.Checkbutton(root, text=&quot;レコード&quot;, variable=var_record)</b> <span class="balloon">← レコードの設定</span>

...(省略)...

course.grid(column=1, row=0) <span class="balloon">← メニュー・ボックス・ボタンの配置:レース場名</span>

...(省略)...
kakutei.grid(column=1, row=13) <span class="balloon">← 確定状況の設定</span>

<b>record.grid(column=1, row=14)</b> <span class="balloon">← レコードの設定</span>
</pre>
</div>
<p>チェックボックスの作成には<code class="inline-code">Checkbutton()</code>を使用します。<code class="inline-code">text</code>でボックスの横に表示するテキストを設定できます。<code class="inline-code">variable</code>では、チェックボックスの状態を格納する変数を指定しています。この変数には、ウィジェット変数という専用のものを使用しています。チェックボックスはTrueまたはFalseの二値なので、<code class="inline-code">tk.BooleanVar()</code>を使用します。</p>
<p>プログラムを実行して、<span class="imgref"><a href="./03-configwindow.html#checkbu">図3.5</a></span>のようにチェックの付け外しができるか確認しましょう。</p>
<div id="checkbu" class="image">
<img src="images/03-configwindow/checkbu.png" alt="作成したチェックボックス" class="img border" />
<p class="caption">
図3.5: 作成したチェックボックス
</p>
</div>
<p></p>
<hr />
<p></p>

<h2 id="button" class="leftline"><a id="h3-5"></a><span class="secno">3.5</span> ボタン</h2>
<p>この章の締めとして、任意の関数を実行できるボタンを作成していきます。</p>
<div id="cbutton" class="caption-code">
<span class="caption">リスト3.6: リスト3.6: ボタンの作成</span>
<pre class="list">import tkinter as tk
from tkinter import ttk
<b>import sys</b>

<b>def createwindow():</b> <span class="balloon">← 掲示板を作り変える関数</span>
<b>    pass</b>

...(省略)...

course = ttk.Combobox(root,  values=['　　','札幌','函館','福島','新潟','中山','東京','中京','京都','阪神','小倉'], width=4) <span class="balloon">← メニュー・ボックス・ボタンの作成:レース場名</span>

...(省略)...

tf_sec10 = tk.Entry(root, width=3)

<b>createbutton = tk.Button(root, text='create', command=createwindow)</b> <span class="balloon">← 設定内容の反映ボタン</span>

<b>exitbutton = tk.Button(root, text='exit', command=sys.exit)</b> <span class="balloon">← プログラム終了用のボタン</span>

...(省略)...

course.grid(column=1, row=0) <span class="balloon">← メニュー・ボックス・ボタンの配置:レース場名</span>

...(省略)...

tf_sec10.grid(column=1, row=21)

<b>createbutton.grid(column=0, row=22)</b> <span class="balloon">← 設定内容の反映</span>
<b>exitbutton.grid(column=1, row=22)</b> <span class="balloon">← プログラムの終了</span>
</pre>
</div>
<p>ボタンの作成には<code class="inline-code">Button()</code>を使用します。<code class="inline-code">text</code>でボタンの中のテキストを設定し、<code class="inline-code">command</code>でボタンが押された際に実行させる関数を設定します。</p>
<p>このプログラムでは、ボタンを押すと設定内容が掲示板に反映される<code class="inline-code">createbutton</code>、ボタンを押すとプログラムが終了する<code class="inline-code">exitbutton</code>を用意しました。</p>
<p><code class="inline-code">createbutton</code>用の関数として、新たに<code class="inline-code">createwindow</code>関数を定義しています。関数の中身は次章で作成していくので、現時点では何もしない関数となっています。</p>
<p>プログラムの終了は、sysモジュールの<code class="inline-code">sys.exit</code>を使用して実装しています。</p>
<p>現時点での完成イメージを<span class="imgref"><a href="./03-configwindow.html#complete">図3.6</a></span>に示します。createボタンを押下できること、exitボタンを押すとプログラムが終了することを確認してください。</p>
<p>これでこの章は終わりです！</p>
<div id="complete" class="image">
<img src="images/03-configwindow/complete.png" alt="この章の完成イメージ" class="img border" />
<p class="caption">
図3.6: この章の完成イメージ
</p>
</div>

        </main>
        <nav class="page-navi">
          <a href="02-tuto.html" class="page-prev">&#9664;</a>
          <a href="04-makeboard.html" class="page-next">&#9654;</a>
        </nav>
        <footer>
        </footer>
      </div>
    </div>
    <script>
function rebuildAndReloadForcedly() {
  fetch('/rebuild.js').then((resp)=>{
    resp.text().then((text)=>{ eval(text); });
  });
}
    </script>
    <script src="/rebuild.js?file=03-configwindow.re"></script>
  </body>
</html>
<!-- layout.html5.erb -->
